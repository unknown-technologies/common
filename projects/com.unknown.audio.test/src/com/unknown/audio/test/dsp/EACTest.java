package com.unknown.audio.test.dsp;

import static org.junit.Assert.assertEquals;

import java.io.IOException;
import java.io.InputStream;

import org.junit.Test;

import com.unknown.audio.dsp.EAC;
import com.unknown.audio.meta.riff.RiffWave;
import com.unknown.audio.test.resources.TestResources;

public class EACTest {
	@Test
	public void test() throws IOException {
		try(InputStream in = TestResources.getStream("test.wav")) {
			RiffWave wav = RiffWave.read(in);
			short[] samples = wav.get16bitSamples();
			double[] normalized = new double[samples.length];
			for(int i = 0; i < samples.length; i++) {
				normalized[i] = samples[i] / 32768.0;
			}
			double[][] result = EAC.eac(normalized);
			assertEquals(44, result.length);
			assertEquals(1024, result[0].length);
		}
	}

	private static final short[] TESTVEC_IN = {
			2383, 6230, 2628, 6366, 2878, 6522, 3117, 6670, 3307, 6759, 3441, 6782, 3540, 6763, 3649, 6722,
			3796, 6694, 4002, 6710, 4236, 6763, 4446, 6828, 4615, 6904, 4735, 7004, 4857, 7149, 5020, 7254,
			5235, 7239, 5465, 7115, 5691, 6951, 5874, 6765, 5965, 6563, 5951, 6381, 5850, 6232, 5675, 6125,
			5478, 6050, 5307, 6039, 5195, 6059, 5163, 6049, 5257, 5985, 5474, 5874, 5772, 5728, 6077, 5587,
			6304, 5417, 6435, 5200, 6483, 4939, 6455, 4669, 6340, 4408, 6161, 4193, 5926, 4056, 5664, 3910,
			5402, 3696, 5115, 3396, 4795, 3072, 4476, 2728, 4184, 2384, 3936, 2064, 3712, 1762, 3521, 1504,
			3374, 1269, 3258, 1003, 3176, 704,
			3159, 413, 3223, 137, 3323, -144, 3446, -427, 3528, -709, 3542,
			-969, 3485, -1181, 3365, -1370, 3258, -1482, 3201, -1518, 3184,
			-1497, 3148, -1446, 3067, -1404, 2937, -1419, 2770, -1512, 2602,
			-1640, 2422, -1769, 2217, -1911, 1992, -2045, 1783, -2151, 1645,
			-2236, 1605, -2360, 1600, -2554, 1593, -2742, 1537, -2919, 1420,
			-3098, 1290, -3270, 1147, -3411, 966, -3541, 734, -3668, 489,
			-3820, 241, -4023, 37, -4247, -105, -4492, -193, -4728, -217,
			-4904, -210, -5065, -236, -5241, -332, -5427, -534, -5621, -833,
			-5767, -1184, -5845, -1526, -5893, -1834, -5904, -2088, -5841,
			-2300, -5735, -2462, -5604, -2597, -5450, -2711, -5325, -2794,
			-5226, -2817, -5134, -2769, -5064, -2701, -5005, -2648, -4952,
			-2619, -4907, -2637, -4858, -2715, -4820, -2825, -4763, -2942,
			-4694, -3025, -4593, -3067, -4387, -3107, -4088, -3190, -3774,
			-3316, -3495, -3458, -3236, -3582, -2993, -3647, -2730, -3608,
			-2460, -3508, -2223, -3389, -2043, -3303, -1907, -3226, -1783,
			-3124, -1634, -3017, -1458, -2905, -1277, -2772, -1128, -2601,
			-1014, -2405, -877, -2172, -752, -1874, -657, -1590, -577,
			-1346, -484, -1153, -398, -1013, -332, -929, -262, -898, -150,
			-916, 38, -965, 331, -1020, 674, -1095, 1029, -1206, 1390,
			-1366, 1715, -1567, 2006, -1774, 2263, -1924, 2473, -2013, 2617,
			-2068, 2695, -2142, 2732, -2230, 2729, -2345, 2697, -2484, 2635,
			-2634, 2547, -2780, 2496, -2942, 2463, -3145, 2419, -3396, 2320,
			-3655, 2168, -3865, 1983, -3981, 1773, -3975, 1596, -3898, 1470,
			-3763, 1406, -3625, 1374, -3537, 1306, -3507, 1206, -3512, 1110,
			-3568, 1025, -3653, 972, -3756, 961, -3844, 976, -3907, 949,
			-3944, 908, -3986, 823, -4049, 701, -4118, 602, -4165, 513,
			-4175, 414, -4203, 342, -4293, 262, -4435, 164, -4588, 42,
			-4707, -110, -4763, -290, -4769, -496, -4732, -712, -4650, -911,
			-4537, -1052, -4423, -1173, -4340, -1288, -4332, -1369, -4368,
			-1412, -4412, -1456, -4388, -1526, -4284, -1655, -4134, -1801,
			-3967, -1940, -3812, -2115, -3689, -2273, -3623, -2377, -3608,
			-2461, -3616, -2554, -3601, -2668, -3523, -2786, -3393, -2891,
			-3230, -2953, -3068, -3003, -2921, -2980, -2789, -2957, -2638,
			-2884, -2467, -2747, -2348, -2605, -2274, -2436, -2234, -2314,
			-2171, -2229, -2085, -2203, -1937, -2190, -1712, -2243, -1419,
			-2326, -1088, -2320, -792, -2288, -571, -2279, -420, -2228,
			-307, -2170, -228, -2142, -155, -2049, -81, -1957, 11, -1868,
			132, -1761, 275, -1717, 454, -1776, 660, -1879, 867, -1984,
			1054, -2138, 1226, -2287, 1385, -2416, 1533, -2504, 1633, -2509,
			1701, -2436, 1741, -2399, 1732, -2379, 1671, -2281, 1565, -2168,
			1433, -2091, 1322, -2013, 1263, -1922, 1255, -1871, 1266, -1832,
			1303, -1772, 1366, -1710, 1472, -1681, 1617, -1746, 1778, -1862,
			1934, -1941, 2063, -1969, 2137, -1995, 2136, -1998, 2071, -1880,
			1982, -1679, 1896, -1469, 1818, -1289, 1791, -1125, 1818, -922,
			1892, -652, 1960, -345, 2006, -41, 2036, 280, 2081, 591, 2113,
			887, 2108, 1185, 2086, 1441, 2059, 1582, 2019, 1635, 1953, 1669,
			1814, 1705, 1621, 1711, 1414, 1716, 1275, 1817, 1213, 1975,
			1237, 2129, 1327, 2266, 1478, 2418, 1707, 2562, 2031, 2692,
			2437, 2848, 2854, 3015, 3237, 3180, 3527, 3332, 3743, 3493,
			3899, 3631, 4013, 3758, 4146, 3970, 4329, 4264, 4552, 4617,
			4820, 4987, 5134, 5259, 5473, 5464, 5796, 5659, 6077, 5843,
			6333, 5980, 6615, 6113, 6897, 6264, 7139, 6409, 7294, 6555,
			7346, 6646, 7338, 6687, 7282, 6701, 7203, 6713, 7116, 6742,
			7019, 6768, 6907, 6791, 6722, 6818, 6474, 6849, 6180, 6898,
			5882, 6943, 5644, 6956, 5522, 6876, 5527, 6714, 5602, 6505,
			5721, 6295, 5841, 6129, 5946, 5984, 6037, 5857, 6113, 5728,
			6148, 5614, 6116, 5534, 6027, 5469, 5889, 5420, 5731, 5378,
			5563, 5298, 5405, 5179, 5213, 4973, 4996, 4687, 4741, 4404,
			4450, 4172, 4133, 3959, 3821, 3762, 3580, 3656, 3395, 3607,
			3257, 3568, 3132, 3549, 2992, 3521, 2851, 3469, 2707, 3384,
			2583, 3226, 2493, 3032, 2408, 2864, 2314, 2708, 2207, 2566,
			2103, 2467, 2014, 2362, 1936, 2245, 1815, 2054, 1630, 1794,
			1389, 1550, 1122, 1294, 844, 987, 570, 647, 324, 355, 108, 86,
			-82, -189, -263, -469, -440, -708, -649, -911, -891, -1129,
			-1121, -1367, -1288, -1574, -1350, -1763, -1335, -1978, -1279,
			-2192, -1201, -2381, -1139, -2538, -1108, -2669, -1107, -2776,
			-1122, -2881, -1165, -3044, -1234, -3235, -1323, -3364, -1440,
			-3456, -1568, -3578, -1715, -3725, -1871, -3865, -2018, -4029,
			-2157, -4181, -2282, -4279, -2385, -4322, -2487, -4322, -2594,
			-4309, -2729, -4319, -2899, -4377, -3066, -4455, -3221, -4546,
			-3362, -4684, -3468, -4839, -3477, -5009, -3381, -5207, -3205,
			-5407, -3005, -5605, -2814, -5792, -2634, -5938, -2441, -6040,
			-2218, -6137, -1986, -6236, -1754, -6311, -1545, -6358, -1390,
			-6356, -1318, -6282, -1290, -6153, -1281, -5957, -1270, -5710,
			-1261, -5500, -1303, -5394, -1410, -5340, -1560, -5336, -1727,
			-5415, -1891, -5538, -2055, -5690, -2237, -5858, -2470, -6000,
			-2786, -6138, -3214, -6284, -3723, -6410, -4213, -6484, -4603,
			-6496, -4858, -6458, -5001, -6412, -5069, -6362, -5110, -6298,
			-5138, -6213, -5174, -6177, -5190, -6224, -5203, -6365, -5236,
			-6580, -5341, -6786, -5566, -6989, -5890, -7166, -6249, -7273,
			-6586, -7294, -6892, -7285, -7155, -7317, -7427, -7385, -7712,
			-7435, -8025, -7444, -8306, -7391, -8509, -7326, -8606, -7237,
			-8622, -7127, -8580, -7023, -8491, -6931, -8355, -6847, -8166,
			-6753, -7906, -6661, -7599, -6592, -7264, -6514, -6908, -6428,
			-6573, -6299, -6257, -6104, -5946, -5858, -5603, -5573, -5217,
			-5249, -4797, -4905, -4358, -4546, -3941, -4163, -3585, -3770,
			-3300, -3357, -3080, -2940, -2887, -2551, -2677, -2175, -2436,
			-1827, -2161, -1554, -1857, -1358, -1558, -1206, -1297, -1058,
			-1077, -912, -864, -749, -625, -570, -407, -379, -225, -156,
			-73, 112, 77, 386, 271, 671, 528, 958, 834, 1248, 1158, 1524,
			1495, 1770, 1830, 2021, 2138, 2312, 2383, 2597, 2561, 2822,
			2687, 3022, 2762, 3209, 2793, 3403, 2792, 3602, 2769, 3828,
			2746, 4092, 2732, 4336, 2760, 4533, 2849, 4696, 2975, 4865,
			3138, 5038, 3328, 5232, 3544, 5457, 3762, 5696, 3980, 5943,
			4164, 6191, 4294, 6465, 4369, 6754, 4388, 7039, 4391, 7319,
			4380, 7564, 4361, 7784, 4337, 7944, 4321, 8053, 4304, 8158,
			4265, 8282, 4201, 8416, 4145, 8543, 4167, 8666, 4231, 8765,
			4307, 8821, 4322, 8861, 4266, 8901, 4178, 8957, 4128, 9039,
			4110, 9150, 4133, 9306, 4160, 9479, 4172, 9615, 4214, 9709,
			4286, 9787, 4377, 9862, 4437, 9940, 4455, 9992, 4444, 10035,
			4411, 10096, 4324, 10189, 4205, 10327, 4057, 10505, 3894, 10700,
			3727, 10875, 3597, 11014, 3477, 11100, 3336, 11161, 3161, 11190,
			2995, 11181, 2897, 11112, 2878, 11014, 2946, 10930, 3068, 10843,
			3175, 10727, 3185, 10582, 3090, 10443, 2916, 10274, 2694, 10043,
			2474, 9762, 2308, 9491, 2240, 9245, 2283, 9034, 2416, 8793,
			2619, 8493, 2881, 8188, 3195, 7911, 3527, 7656, 3807, 7394,
			3986, 7119, 4049, 6838, 4040, 6564, 4031, 6307, 4049, 6057,
			4091, 5777, 4118, 5459, 4109, 5137, 4048, 4840, 3946, 4521,
			3806, 4146, 3622, 3691, 3384, 3177, 3077, 2638, 2705, 2103,
			2314, 1615, 1947, 1176, 1654, 753, 1429, 314, 1257, -168, 1137,
			-658, 1022, -1112, 883, -1482, 677, -1801, 390, -2135, 70,
			-2482, -265, -2829, -625, -3156, -1037, -3468, -1482, -3764,
			-1924, -4073, -2329, -4409, -2692, -4803, -2986, -5227, -3235,
			-5651, -3477, -6051, -3741, -6398, -4021, -6700, -4283, -6937,
			-4476, -7097, -4612, -7183, -4710, -7194, -4770, -7147, -4810,
			-7057, -4842, -6914, -4888, -6774, -4946, -6674, -5012, -6607,
			-5063, -6581, -5048, -6617, -4959, -6711, -4839, -6836, -4698,
			-6963, -4548, -7064, -4374, -7145, -4200, -7202, -4007, -7231,
			-3817, -7260, -3609, -7273, -3407, -7268, -3229, -7234, -3069,
			-7194, -2906, -7105, -2718, -6986, -2533, -6895, -2338, -6859,
			-2112, -6882, -1857, -6952, -1599, -7046, -1349, -7108, -1123,
			-7136, -929, -7136, -763, -7084, -640, -6990, -535, -6854, -448,
			-6726, -371, -6622, -311, -6504, -287, -6382, -239, -6233, -175,
			-6085, -112, -5906, 7, -5708, 193, -5494, 434, -5275, 683,
			-5030, 946, -4790, 1132, -4615, 1209, -4507, 1200, -4473, 1125,
			-4479, 1057, -4507, 1034, -4522, 1001, -4528, 961, -4543, 958,
			-4555, 1006, -4541, 1081, -4488, 1145, -4364, 1187, -4180, 1216,
			-3961, 1217, -3734, 1199, -3529, 1209, -3362, 1251, -3259, 1259,
			-3184, 1266, -3127, 1278, -3051, 1269, -2945, 1224, -2841, 1125,
			-2765, 976, -2719, 785, -2674, 614, -2614, 442, -2532, 271,
			-2445, 92, -2360, -80, -2274, -232, -2172, -386, -2055, -566,
			-1933, -752, -1797, -935, -1656, -1138, -1481, -1344, -1291,
			-1505, -1100, -1598, -922, -1652, -757, -1661, -593, -1646,
			-444, -1625, -320, -1679, -229, -1748, -192, -1768, -194, -1766,
			-192, -1784, -149, -1858, -68, -1958, 53, -2086, 180, -2196,
			321, -2285, 462, -2360, 586, -2429, 682, -2495, 783, -2562, 905,
			-2636, 1024, -2745, 1143, -2909, 1256, -3088, 1359, -3221, 1431,
			-3301, 1427, -3373, 1382, -3448, 1349, -3469, 1306, -3418, 1265,
			-3315, 1243, -3137, 1255, -2894, 1293, -2609, 1364, -2313, 1424,
			-1927, 1479, -1557, 1481, -1252, 1450, -838, 1564, -484, 1619,
			-269, 1518, -137, 1367, 1, 1310, 179, 1361, 237, 1383, 149,
			1310, 0, 1164, -129, 1057, -135, 1076, -181, 1038, -260, 945,
			-169, 1039, -109, 1122, -109, 1139, -153, 1081, -49, 1091, 171,
			1161, 206, 1031, 251, 898, 418, 910, 459, 872, 327, 744, 222,
			693, 55, 637, -148, 544, -339, 478, -588, 333, -885, 128, -1073,
			38, -1251, -30, -1551, -227, -1764, -356, -1945, -448, -2037,
			-477, -2078, -442, -2300, -601, -2681, -905, -3004, -1125,
			-3153, -1209, -3217, -1269, -3234, -1282, -3205, -1213, -3313,
			-1273, -3419, -1315, -3453, -1240, -3467, -1153, -3387, -1005,
			-3326, -921, -3320, -893, -3362, -884, -3344, -816, -3313, -757,
			-3331, -784, -3363, -865, -3309, -895, -3075, -725, -2906, -511,
			-2879, -318, -2912, -145, -2923, 11, -2799, 239, -2497, 539,
			-2225, 722, -2061, 752, -1801, 878, -1464, 1073, -1115, 1257,
			-711, 1449, -269, 1669, 180, 1902, 606, 2072, 1070, 2326, 1496,
			2615, 1812, 2850, 2194, 3188, 2627, 3609, 3062, 4066, 3413,
			4445, 3790, 4855, 4190, 5347, 4508, 5742, 4767, 5966, 5023,
			6068, 5312, 6169, 5549, 6211, 5822, 6243, 6107, 6313, 6295,
			6375, 6429, 6425, 6492, 6423, 6456, 6393, 6426, 6403, 6518,
			6510, 6633, 6618, 6721, 6720, 6919, 6872, 7200, 6993, 7522,
			7074, 7815, 7086, 8075, 7018, 8341, 6929, 8537, 6791, 8654,
			6588, 8714, 6362, 8727, 6143, 8675, 5937, 8576, 5741, 8430,
			5570, 8278, 5402, 8027, 5118, 7707, 4804, 7332, 4506, 6890,
			4196, 6438, 3917, 6053, 3682, 5770, 3474, 5492, 3141, 5214,
			2707, 4939, 2228, 4726, 1762, 4646, 1395, 4693, 1167, 4755,
			1037, 4736, 874, 4600, 603, 4400, 271, 4214, 17, 4001, -189,
			3769, -371, 3566, -512, 3435, -558, 3349, -533, 3280, -475,
			3189, -406, 3014, -348, 2696, -348, 2342, -356, 2005, -387,
			1713, -459, 1576, -508, 1560, -536, 1597, -559, 1618, -565,
			1500, -640, 1313, -723, 1128, -747, 961, -769, 845, -799, 777,
			-861, 698, -944, 619, -1003, 561, -1040, 504, -1111, 482, -1211,
			519, -1280, 552, -1354, 557, -1411, 570, -1410, 627, -1353, 670,
			-1253, 658, -1169, 619, -1177, 543, -1240, 492, -1243, 450,
			-1210, 413, -1191, 434, -1165, 468, -1176, 547, -1205, 695,
			-1210, 885, -1227, 1090, -1250, 1292, -1262, 1428, -1308, 1493,
			-1378, 1560, -1387, 1624, -1330, 1681, -1244, 1726, -1120, 1695,
			-1025, 1547, -1053, 1313, -1153, 1070, -1219, 907, -1201, 809,
			-1119, 731, -1034, 653, -945, 507, -925, 297, -948, 4, -1054,
			-312, -1227, -563, -1374, -720, -1464, -902, -1541, -1151,
			-1685, -1356, -1817, -1500, -1905, -1635, -1986, -1775, -2078,
			-2005, -2259, -2315, -2502, -2632, -2691, -2959, -2840, -3318,
			-2997, -3704, -3148, -4074, -3243, -4441, -3310, -4722, -3283,
			-4923, -3163, -5177, -3017, -5571, -2956, -6071, -2956, -6531,
			-2921, -6923, -2853, -7349, -2805, -7802, -2796, -8221, -2823,
			-8572, -2936, -8882, -3092, -9138, -3202, -9336, -3202, -9545,
			-3151, -9818, -3139, -10075, -3122, -10300, -3131, -10440,
			-3164, -10434, -3181, -10362, -3229, -10268, -3340, -10128,
			-3473, -9960, -3589, -9772, -3632, -9561, -3638, -9366, -3654,
			-9122, -3590, -8845, -3435, -8626, -3287, -8397, -3127, -8121,
			-2973, -7824, -2894, -7473, -2846, -7138, -2854, -6887, -2882,
			-6722, -2850, -6610, -2773, -6499, -2634, -6444, -2521, -6450,
			-2485, -6469, -2493, -6380, -2430, -6279, -2354, -6239, -2327,
			-6163, -2256, -6054, -2171, -5886, -2067, -5711, -1995, -5535,
			-1947, -5343, -1874, -5126, -1783, -4976, -1777, -4838, -1835,
			-4617, -1864, -4349, -1917, -4074, -1994, -3830, -2096, -3622,
			-2218, -3446, -2330, -3301, -2476, -3192, -2653, -3073, -2771,
			-2916, -2838, -2748, -2900, -2559, -2904, -2349, -2817, -2172,
			-2679, -2003, -2446, -1840, -2173, -1685, -1916, -1471, -1664,
			-1189, -1398, -924, -1233, -661, -1132, -364, -1025, -48, -1001,
			326, -968, 669, -925, 925, -875, 1095, -828, 1232, -744, 1361,
			-625, 1475, -489, 1588, -284, 1671, -87, 1717, 46, 1746, 181
	};

	private static final double[] TESTVEC_OUT = { 0.0, 0.0, 468.41393946382334, 0.0, 0.0, 0.0, 343.65847853727746,
			0.0,
			0.0, 0.0, 263.6758906450518, 0.0, 0.0, 0.0, 205.25843485982847, 0.0, 0.0, 0.0,
			166.33986601474643, 0.0, 0.0, 0.0, 137.43958020428002, 0.0, 0.0, 0.0, 123.83226610290977, 0.0,
			0.0, 0.0, 107.02438807504637, 0.0, 0.0, 0.0, 86.8253355852422, 0.0, 0.0, 0.0, 65.3422735886754,
			0.0, 0.0, 0.0, 63.06356096021784, 0.0, 0.0, 0.0, 48.48592807918263, 0.0, 0.0, 0.0,
			26.70391760788189, 0.0, 0.0, 0.0, 14.938294610506702, 0.0, 0.0, 0.0, 4.788559250949049, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6450318714478129, 0.0, 1.9974994928512153,
			0.0, 2.2398223860398065, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.753965607700609, 0.0,
			8.660479815017686, 1.7501439192381296, 11.563573133219471, 9.254358951058062,
			13.829044541128987, 19.116911360919566, 13.998266671902876, 27.009123945231767,
			15.06328911671558, 30.79920400408035, 14.132118270076099, 32.43852098182486, 13.179736818351389,
			33.57002977720951, 10.67962306880187, 33.520491688883965, 7.522169853773315, 32.98519889280584,
			4.642368756003271, 30.15735504425485, 2.1483710949777084, 25.69886374337188, 0.184776259693054,
			22.42365095413136, 0.0, 17.8214341755043, 0.0, 14.782301451534233, 0.0, 12.201964297528473, 0.0,
			11.487217652894932, 0.0, 9.120366681914955, 0.0, 9.017946727068662, 0.6256878986395238,
			9.835101630731955, 3.4497122159096545, 11.297238932546076, 6.703887598773025,
			12.364496411703556, 8.120341216852655, 11.685853310945367, 7.367866168025192,
			11.392283631635024, 7.730157447679256, 11.95533357546817, 7.687731975747513, 11.970880022533736,
			8.643659219011733, 7.980430681894168, 9.330402814407767, 3.09738473575522, 8.953575107898045,
			1.2190184848413832, 7.1337608562158445, 0.0, 6.413691135068224, 0.0, 6.0800965857029485, 0.0,
			7.360101877940652, 0.0, 9.50226771313806, 0.0, 10.064982566549565, 0.0, 10.158301786097468, 0.0,
			9.953715290492884, 0.0, 9.550728581791883, 0.0, 10.92752921230112, 0.0, 11.909242887320122, 0.0,
			12.427213661898831, 3.0244615560709316, 12.366414053947919, 8.954970981982491,
			10.588194618479562, 13.516925004285309, 8.632716464929743, 18.008575405618735,
			7.312780447785829, 20.791368995921907, 8.637311432394394, 21.35237695086481, 8.354038553986872,
			17.70170788675644, 8.463002795964242, 11.95339343709917, 10.478299136488188, 5.66505850193816,
			11.202368652679306, 0.0, 11.529338528079622, 0.0, 9.945452348387185, 0.0, 9.299727280020786,
			0.0, 8.767454235064543, 0.0, 10.784030178287026, 0.0, 12.440243456598097, 0.0,
			12.999180430393967, 0.0, 11.335832426623424, 0.0, 9.309403414034582, 0.0, 7.887873572815835,
			0.28333129710423677, 7.682897742848427, 1.086131050740713, 7.498011610893563,
			1.7300916069003902, 7.39528062303434, 5.679541797597728, 9.027988200267567, 7.602885440224449,
			10.896728971792653, 9.357408891784914, 12.840455218925133, 10.706030844170598,
			13.354213869786587, 12.956141561659633, 14.844673194217652, 14.06168109134734,
			12.349301740948135, 12.804305632159618, 9.631826189853193, 8.723228502193573, 7.216859122454031,
			6.078300105716199, 5.282457701227852, 7.1628286981614675, 3.6829986705298885, 9.435375561363006,
			1.4544500318341327, 10.952361930218977, 2.392702289676126, 10.581488398209181,
			4.346126042479929, 11.75386947639266, 8.223257576606272, 15.078348865482267, 12.467773816178678,
			18.935184578145112, 15.921656243489046, 21.718139136527956, 17.915921881630766,
			24.145517019370445, 18.784937848194943, 26.28501133417839, 19.118367398764, 30.32908658562743,
			20.11320395850112, 35.66181343812498, 21.986647908303087, 38.2982336962796, 22.75855252206454,
			39.700062010926395, 23.236724180743593, 39.4993466508956, 23.174224733826417,
			37.154603828436095, 23.325744664802922, 35.47527220692035, 21.65575091023021, 34.65516295541445,
			19.766769813247755, 34.13623649617664, 17.565745918965582, 33.35630821015046,
			17.028784043054678, 31.75751698013015, 15.541896526400928, 27.513366472798772,
			13.904169948757142, 23.47270766749924, 13.126683970190523, 20.995608295545217,
			11.087982840803782, 19.481305613045578, 8.411667912914147, 18.36211185978572, 6.584847888822782,
			17.425416528599946, 6.77917365033347, 18.217625242220706, 8.986555337502109, 19.142829239660106,
			11.040603025337191, 18.276467173798114, 12.950141073800797, 17.686544392616526,
			14.161342199054804, 18.031196907381155, 14.596348482868379, 19.425531042642202,
			15.90564592275763, 22.409056705717333, 16.975870717263156, 26.708280313862595,
			16.987181506631753, 29.186882532675646, 16.55889388481581, 34.663846002177394,
			14.61142491603109, 39.69260936361915, 12.257962795246687, 43.890743748783436,
			10.319556375968341, 46.51508089014211, 8.44457135214781, 43.67118748953375, 7.814638536122136,
			39.22992090599364, 8.247530250193908, 33.070133381854355, 8.101867793039716, 28.03146493022286,
			8.120105005350892, 22.983797730629295, 8.360647992572712, 18.969875233799954, 7.521732272605527,
			15.5723350521945, 7.519415677798796, 14.625912001840753, 8.634536925926149, 13.045840149194392,
			10.765833130806666, 12.318029642397345, 12.693115388734402, 12.73663369652995,
			12.470630587425255, 11.514160975189231, 10.781076146408084, 10.201805458549714,
			9.645370422301784, 7.325170118716303, 9.075475875686045, 3.948788183874611, 7.816165414332703,
			0.0, 7.276256456305932, 0.0, 7.08145863168764, 0.0, 6.027957920231276, 0.0, 6.3762728896172085,
			0.0, 7.195112755242944, 0.0, 9.23866102250849, 0.0, 10.447785305643293, 0.0, 11.475783546074773,
			0.0, 10.04695630487764, 0.0, 8.08451466741992, 0.0, 7.445209343508519, 0.0, 7.222930648644577,
			0.0, 6.77790072941753, 0.0, 5.166239954769287, 0.0, 2.7817849535039563, 0.0, 1.9357465168258794,
			0.0, 1.9033054367190503, 0.0, 1.5807951024927434, 0.0, 2.685644729741041, 0.0,
			4.595592067233168, 0.0, 7.481653543541644, 0.0, 9.537256353264496, 0.0, 11.575563824742705, 0.0,
			12.697554382305091, 0.0, 13.109334576352847, 0.0, 14.255353450638129, 0.0, 14.944095772246554,
			0.0, 14.372740812629601, 0.0, 15.774500449868807, 0.0, 14.568493834723416, 0.0,
			14.420067257905302, 0.0, 13.593114536855657, 0.0, 10.14645983877307, 0.0, 9.693165926513421,
			0.0, 5.754447604642692, 0.0, 6.1957649784463555, 0.0, 2.4583775114100845, 0.0,
			2.361057629604854, 0.0, 0.41172589585756114, 0.0, 0.09620003904878871, 0.0, 0.0, 0.0, 0.0,
			1.5548187705425605, 0.0, 0.0, 0.0, 6.506611147929359, 0.0, 0.0, 0.0, 9.477262418241493, 0.0,
			0.0, 0.0, 14.022553892719586, 0.0, 0.0, 0.0, 15.475088127014498, 0.21364168684347717, 0.0,
			0.6949626337019588, 14.692235976831212, 0.970660089845202, 0.0, 0.0, 14.72593140809972,
			1.4679480294926037, 0.0, 1.8835223326782113, 15.725791858050403, 4.9618324648829,
			1.076659617299347, 5.022469409249669, 16.334459204926972, 4.084354772591508, 3.5261880538982204,
			2.9152748653210416, 16.244075562232396, 2.511098844083933, 4.621079841094277, 1.939610351703549,
			15.900996645477987, 2.7645404708301795, 6.393338758269518, 1.5858964791040213,
			14.627300185611189, 0.7618244290626581, 3.057607297693856, 0.25384630004680453,
			10.03014021232195, 0.0, 0.1804593727706596, 0.0, 6.233336927129507, 0.0, 0.0, 0.0,
			2.6259920422238308, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.3545533354726089, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			4.309547773900363, 0.0, 0.0, 0.0, 8.65318286152969, 0.0, 0.0, 0.0, 10.095655350251636, 0.0, 0.0,
			0.0, 5.623976420060391, 0.0, 0.0, 0.0, 0.6921540170320757, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.3558715242388457, 0.0, 0.0, 0.0, 4.416123154452727, 0.0, 0.0, 0.0, 1.0450643904241304, 0.0,
			0.0, 0.0, 0.3982131944194194, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			1.2788013041231885, 0.0, 0.0, 0.0, 0.8180184378049296, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
			0.0, 0.0, 0.0, 0.0, 0.0 };

	@Test
	public void testvec() {
		double[] normalized = new double[TESTVEC_IN.length];
		for(int i = 0; i < TESTVEC_IN.length; i++) {
			normalized[i] = TESTVEC_IN[i] / 32768.0;
		}
		double[][] result = EAC.eac(normalized);
		assertEquals(1, result.length);
		for(int i = 0; i < result[0].length; i++) {
			assertEquals(TESTVEC_OUT[TESTVEC_OUT.length - 1 - i], result[0][i] * (2048 / 4), 1e-8);
		}
	}
}
